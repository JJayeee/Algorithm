"""
매 초마다, 불은 동서남북 방향으로 인접한 빈 공간으로 퍼져나간다.
벽에는 불이 붙지 않는다.
상근이는 동서남북 인접한 칸으로 이동할 수 있으며, 1초가 걸린다.
상근이는 벽을 통과할 수 없고,
불이 옮겨진 칸 또는 이제 불이 붙으려는 칸으로 이동할 수 없다.
상근이가 있는 칸에 불이 옮겨옴과 동시에 다른 칸으로 이동할 수 있다.
"""


def is_wall(x, y):
    return 0 <= x < n and 0 <= y < m


def is_door(x, y):
    return x == 0 or x == n-1 or y == 0 or y == m-1


def BFS(k_sanguen, k_time, k_fires):
    global min_time

    for k_sx, k_sy in k_sanguen:
        if is_door(k_sx, k_sy):
            min_time = min(min_time, k_time)
            break
    else:
        n_fires = []
        for k_fx, k_fy in k_fires:
            for dx, dy in dxdy:
                n_fx, n_fy = k_fx + dx, k_fy + dy
                if is_wall(n_fx, n_fy) and arr[n_fx][n_fy] < 1:
                    arr[n_fx][n_fy] = 2
                    n_fires.append((n_fx, n_fy))

        n_sanguen = []
        for k_sx, k_sy in k_sanguen:
            for dx, dy in dxdy:
                n_sx, n_sy = k_sx + dx, k_sy + dy
                if is_wall(n_sx, n_sy) and not arr[n_sx][n_sy]:
                    arr[n_sx][n_sy] = -1
                    n_sanguen.append((n_sx, n_sy))

        if n_sanguen:
            BFS(n_sanguen, k_time + 1, n_fires)



def start():
    fires = []
    sanguen = []
    for x in range(n):
        for y in range(m):
            if arr[x][y] == 2:
                fires.append((x, y))
            elif arr[x][y] == 1:
                sanguen.append((x, y))
                arr[x][y] = -1
    BFS(sanguen, 0, fires)


WtN = {'#': 3, '*': 2, '@': 1, '.': 0}
dxdy = [(0, 1), (0, -1), (1, 0), (-1, 0)]
for _ in range(int(input())):
    m, n = map(int, input().split())
    arr = [[WtN[w] for w in input()] for _ in range(n)]

    min_time = 1000001
    start()

    if min_time == 1000001:
        print('IMPOSSIBLE')
    else:
        print(min_time + 1)


"""


5
4 3
####
#*@.
####
7 6
###.###
#*#.#*#
#.....#
#.....#
#..@..#
#######
7 4
###.###
#....*#
#@....#
.######
5 5
.....
.***.
.*@*.
.***.
.....
3 3
###
#@#
###

1
3 3
###
#@.
##*


"""

"""
21
1 1
@
3 3
.#.
#@#
.#.
3 3
...
.@.
...
3 3
.#.
#@#
.#*
8 3
########
#*@.....
########
5 6
##.##
#...#
#.#.#
#.#@#
#*#.#
#####
5 6
##.##
#...#
#.#.#
#*#@#
#.#.#
#####
5 6
##.##
#...#
#*#.#
#.#@#
#.#.#
#####
8 9
########
#......#
#.####.#
#.#@.#.#
#.##.#.#
#....#.#
######.#
.......#
########
5 3
##.##
#*.@#
#####
7 7
.......
.*#.##.
.##.##.
...@...
.##.##.
.##.#*.
.......
7 7
......*
.##.##.
.##.##.
...@...
.##.##.
.##.##.
*......
7 7
.*....*
.##.##.
.##.##.
...@...
.##.##.
.##.##.
.*....*
7 7
.......
*##.##*
.##.##.
...@...
.##.##.
.##.##.
*.....*
7 7
*....*.
.##.##.
.##.##.
...@...
.##.##.
.##.##.
*....*.
7 7
*.....*
.##.##.
.##.##.
...@...
.##.##.
*##.##*
.......
7 7
..#.#..
.*#.#*.
.##.##.
...@...
.##.##.
.*#.#*.
.......
7 7
.......
.*#.#*.
.##.###
...@...
.##.###
.*#.#*.
.......
7 7
.......
.*#.#*.
###.##.
...@...
###.##.
.*#.#*.
.......
7 7
.......
.*#.#*.
.##.##.
...@...
.##.##.
.*#.#*.
..#.#..
5 3
..#..
.@#*.
..#..

1
IMPOSSIBLE
2
IMPOSSIBLE
6
5
IMPOSSIBLE
IMPOSSIBLE
28
IMPOSSIBLE
IMPOSSIBLE
IMPOSSIBLE
4
4
4
4
4
4
4
4
2
"""

"""
1
5 5
..#.#
....#
#*#..
#.@.#
###..

1
3 3
*.*
.@.
*.*


1
50 50
##################################################
#@...............................................#
#................................................#
#................................................#
#................................................#
#................................................#
#................................................#
#................................................#
#................................................#
#................................................#
#................................................#
#................................................#
#................................................#
#................................................#
#................................................#
#................................................#
#................................................#
#................................................#
#................................................#
#................................................#
#................................................#
#................................................#
#................................................#
#................................................#
#................................................#
#................................................#
#................................................#
#................................................#
#................................................#
#................................................#
#................................................#
#................................................#
#................................................#
#................................................#
#................................................#
#................................................#
#................................................#
#................................................#
#................................................#
#................................................#
#................................................#
#................................................#
#................................................#
#................................................#
#................................................#
#................................................#
#................................................#
#................................................#
#................................................#
##########################################.#######

"""